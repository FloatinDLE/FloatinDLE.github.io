<!DOCTYPE html>
<html  lang=en>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  
    
    <link rel="shortcut icon" href="/images/kou.ico ">
    
    
    <link rel="icon" type="image/png" href="/images/favicon-android.png " sizes="192x192">
    
    
    <link rel="apple-touch-icon" href="/images/favicon-apple.png " sizes="180x180">
    
  
  <!-- title -->
  <title>地下室 中央处理器CPU </title>
  <!-- styles -->
  <!-- styles -->

<link rel="stylesheet" href="/styles/global.css">

  <!-- rss -->
  
<meta name="generator" content="Hexo 5.4.1"></head>
  <body>
    <header id="header">
  
  <nav class="menu menu--right">
  
    <a class="menu__item" href="/">主页</a>
    <a class="menu__item" href="/archives/">归档</a>
    <a class="menu__item" href="/categories/">专题</a>
    <a class="menu__item" href="/tags/">标签</a>
    <!-- <a class="menu__item" href="/">作品</a> -->
    <!-- <a class="menu__item" href="/about/">关于</a> -->
  </nav>
</header>
    <main>
      <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post__header">
  <h1 class="post__title">中央处理器CPU</h1>
  
  
  <div class="post__meta">
    
<time class="post__date" datetime="2022-01-07T01:43:25.000Z" itemprop="datePublished">
  
  <i class="blogfont">&#xedff;</i>
  
  2022-01-07 09:43:25
</time>

    
<div class="post__category">
  <i class="blogfont">&#xe62d;</i>
  <a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">计算机组成原理</a>
</div>
  

    

    <div id="/2022/01/07/%E4%B8%AD%E5%A4%AE%E5%A4%84%E7%90%86%E5%99%A8CPU/" class="leancloud_visitors post__stat" data-flag-title="中央处理器CPU">
  <i class="blogfont">&#xe672;</i>
  <span class="leancloud-visitors-count">loading...</span>
</div>
  </div>
</header>
  <aside class="post__aside">
  <div class="post__actions">
    <a id="backTop" class="post__top" href="javascript:">
      <i class="blogfont">&#xe6b1;</i><!-- Top -->
    </a>
    <a id="share" class="post__share" href="javascript:">
      <i class="blogfont">&#xe6c1;</i>
    </a>
  </div>
  <ol class="post__toc"><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#CPU%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="post__toc-text">CPU的功能和基本结构</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%8A%9F%E8%83%BD"><span class="post__toc-text">功能</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="post__toc-text">基本结构</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E6%8C%87%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="post__toc-text">指令执行过程</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%8C%87%E4%BB%A4%E5%91%A8%E6%9C%9F"><span class="post__toc-text">指令周期</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%91%A8%E6%9C%9F%E5%86%85%E7%9A%84%E4%BF%A1%E6%81%AF%E6%B5%81"><span class="post__toc-text">周期内的信息流</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%8C%87%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%96%B9%E6%A1%88"><span class="post__toc-text">指令执行方案</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E6%95%B0%E6%8D%AE%E9%80%9A%E8%B7%AF%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="post__toc-text">数据通路的功能和基本结构</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%8A%9F%E8%83%BD-1"><span class="post__toc-text">功能</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84-1"><span class="post__toc-text">基本结构</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%81"><span class="post__toc-text">数据传送</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="post__toc-text">控制器的功能和工作原理</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E5%8A%9F%E8%83%BD"><span class="post__toc-text">控制器功能</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%BE%AE%E5%91%BD%E4%BB%A4"><span class="post__toc-text">微命令</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E7%A1%AC%E5%B8%83%E7%BA%BF%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="post__toc-text">硬布线控制器</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%BE%AE%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="post__toc-text">微程序控制器</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E5%BC%82%E5%B8%B8%E5%92%8C%E4%B8%AD%E6%96%AD%E6%9C%BA%E5%88%B6"><span class="post__toc-text">异常和中断机制</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%BC%82%E5%B8%B8%E5%92%8C%E4%B8%AD%E6%96%AD%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post__toc-text">异常和中断的基本概念</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%BC%82%E5%B8%B8%E5%92%8C%E4%B8%AD%E6%96%AD%E7%9A%84%E5%88%86%E7%B1%BB"><span class="post__toc-text">异常和中断的分类</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%BC%82%E5%B8%B8%E5%92%8C%E4%B8%AD%E6%96%AD%E7%9A%84%E6%A3%80%E6%B5%8B%E4%B8%8E%E5%93%8D%E5%BA%94"><span class="post__toc-text">异常和中断的检测与响应</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E6%8C%87%E4%BB%A4%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="post__toc-text">指令流水线</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F"><span class="post__toc-text">执行方式</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%88%86%E7%B1%BB"><span class="post__toc-text">分类</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87"><span class="post__toc-text">性能指标</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%BD%B1%E5%93%8D%E5%9B%A0%E7%B4%A0"><span class="post__toc-text">影响因素</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%A4%9A%E5%8F%91%E6%8A%80%E6%9C%AF"><span class="post__toc-text">多发技术</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post__toc-text">多处理器的基本概念</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#SISD%E3%80%81SIMD%E3%80%81MIMD%E3%80%81%E5%90%91%E9%87%8F%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post__toc-text">SISD、SIMD、MIMD、向量处理器的基本概念</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E7%A1%AC%E4%BB%B6%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post__toc-text">硬件多线程的基本概念</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%A4%9A%E6%A0%B8%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post__toc-text">多核处理器的基本概念</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post__toc-text">共享内存多处理器的基本概念</span></a></li></ol></li></ol>
</aside>
  <div class="post__content" itemprop="articleBody">
    <h2 id="CPU的功能和基本结构"><a href="#CPU的功能和基本结构" class="headerlink" title="CPU的功能和基本结构"></a>CPU的功能和基本结构</h2><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul>
<li><p>指令控制</p>
<ul>
<li><p>取值、分析、执行，即程序的顺序控制</p>
<ul>
<li>控制器</li>
</ul>
</li>
</ul>
</li>
<li><p>操作控制</p>
<ul>
<li>产生完成指令所需的控制指令</li>
</ul>
</li>
<li><p>时间控制</p>
<ul>
<li>对各种操作加以时间上的控制</li>
</ul>
</li>
<li><p>数据加工</p>
<ul>
<li><p>算术和逻辑运算</p>
<ul>
<li>运算器</li>
</ul>
</li>
</ul>
</li>
<li><p>中断处理</p>
<ul>
<li><p>处理异常情况和特殊请求</p>
<ul>
<li>控制器 <span id="more"></span></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h3><ul>
<li><p>运算器</p>
<ul>
<li><p>算术逻辑单元</p>
<ul>
<li>进行算术&#x2F;逻辑运算</li>
</ul>
</li>
<li><p>通用寄存器组</p>
<ul>
<li><p>用于存放操作数和各种地址信息</p>
<ul>
<li>AX（AH|AL）、BX、SP</li>
</ul>
</li>
<li><p>通用寄存器的位数取决于机器字长</p>
</li>
<li><p>每个都与ALU有专用数据通路，为了不同时一直向ALU传输</p>
<ul>
<li><p>使用多路选择器MUX，根据控制信号选择一路输出</p>
<p>  - </p>
</li>
<li><p>使用三态门（每根线一个）控制是否能输出</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> （性能高，结构复杂，硬件量大）</p>
<pre><code>- 暂存寄存器

    - 暂存从主存读来的数据，不能存在通用中，会破坏原有内容。对应用程序员透明（不知道存在）。

- 累加寄存器

    - 暂存ALU运算结果，可作为加法运算一个输入端

- 程序状态字寄存器

    - OF、SF、ZF等，参与并决定微操作的形成

- 移位器

    - 对操作数或运算结果进行移位运算

- 计数器

    - 控制乘除的操作步数
</code></pre>
<ul>
<li><p>控制器</p>
<ul>
<li><p>程序计数器</p>
<ul>
<li>指出下一条指令在主存中的存放地址，自增</li>
</ul>
</li>
<li><p>指令寄存器</p>
<ul>
<li>保存当前正在执行的那条指令</li>
</ul>
</li>
<li><p>指令译码器</p>
<ul>
<li>对【操作码字段】译码，向控制器提供特定的操作信号</li>
</ul>
</li>
<li><p>微操作信号发生器</p>
<ul>
<li>根据IR的内容、PSW的内容及时序信号，产生控制整个计算机系统所需的各种控制信号</li>
</ul>
</li>
<li><p>时序系统</p>
<ul>
<li>用于产生各种时序信号，由统一时钟CLOCK分频得到</li>
</ul>
</li>
<li><p>存储器地址寄存器</p>
<ul>
<li>用来保存要被写入地址单元或者从地址单元读入的数据</li>
</ul>
</li>
<li><p>存储器数据寄存器</p>
<ul>
<li>用来保存数据被传输到的位置的地址或者数据来源位置的地址</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="指令执行过程"><a href="#指令执行过程" class="headerlink" title="指令执行过程"></a>指令执行过程</h2><h3 id="指令周期"><a href="#指令周期" class="headerlink" title="指令周期"></a>指令周期</h3><ul>
<li><p>从主存中取出并执行一条指令的时间成为指令周期</p>
<ul>
<li>1个指令周期&#x3D;n个机器周期&#x3D;n×m个时钟周期</li>
</ul>
</li>
</ul>
<p> （节拍、T周期，CPU操作的最基本单位）</p>
<pre><code>    - 定长机器周期

        - 每个微命令的节拍数相同
        - 一般以访存的节拍数为参考
        - 把微操作安排在末尾节拍

    - 不定长机器周期
</code></pre>
<ul>
<li><p>指令周期&#x3D;取指周期FE+间址周期IND+执行周期EX+中断周期INT（字母是对应的标志触发器，1有效）</p>
<ul>
<li>空指令：FE</li>
<li>加法：FE+EX</li>
<li>乘法：FE+EX（长些）</li>
<li>具有间接寻址的指令：FE+IND+EX</li>
<li>具有中断周期的指令：FE+IND+EX+INT</li>
</ul>
</li>
</ul>
<h3 id="周期内的信息流"><a href="#周期内的信息流" class="headerlink" title="周期内的信息流"></a>周期内的信息流</h3><ul>
<li><p>取值周期</p>
<ul>
<li>1.(PC)→MAR  2. 1→R &#x2F;&#x2F;读操作（1→W 写）3. M(MAR)→MDR   4.(MDR)→IR</li>
</ul>
</li>
</ul>
<p> 5.OP(IR)→CU  6.(PC)+”1”→PC<br>    - 指令字长等于存储字长，则取指周期等于机器周期；取指是自动进行的，控制器不需要得到指令</p>
<ul>
<li><p>间址周期</p>
<ul>
<li>1.AD(IR)[或MDR]→MAR  2.I→R</li>
</ul>
</li>
</ul>
<p>3.M(MAR)→MDR  4.(MDR)→AD(IR) &#x2F;&#x2F;用真实地址替换指令中的虚址<br>    - 间址周期结束后，MDR中为操作数地址</p>
<ul>
<li><p>执行周期</p>
<ul>
<li>不一定</li>
</ul>
</li>
<li><p>中断周期</p>
<ul>
<li>1.(SP)-1→SP ;(SP)→MAR&#x2F;&#x2F;保存断点  2.1→W  3.(PC)→MDR  4.中断服务程序入口地址→PC</li>
<li>中断周期用于响应中断，有中断则在执行周期后进入中断周期</li>
</ul>
</li>
</ul>
<h3 id="指令执行方案"><a href="#指令执行方案" class="headerlink" title="指令执行方案"></a>指令执行方案</h3><ul>
<li><p>单指令周期</p>
<ul>
<li><p>所有指令的执行时间都相同（同最长的那个）</p>
<ul>
<li>设计简单，运行速度慢</li>
</ul>
</li>
</ul>
</li>
<li><p>多指令周期</p>
<ul>
<li><p>不同类型选用不同执行步骤</p>
<ul>
<li>设计复杂</li>
</ul>
</li>
</ul>
</li>
<li><p>流水线方案</p>
<ul>
<li>力争每个时钟脉冲周期完成一条指令的执行过程，每个时钟周期启动一条，多条指令并行</li>
</ul>
</li>
</ul>
<h2 id="数据通路的功能和基本结构"><a href="#数据通路的功能和基本结构" class="headerlink" title="数据通路的功能和基本结构"></a>数据通路的功能和基本结构</h2><h3 id="功能-1"><a href="#功能-1" class="headerlink" title="功能"></a>功能</h3><ul>
<li><p>实现CPU内部的运算器与寄存器、寄存器之间的数据交换</p>
<ul>
<li>数据在功能部件之间传送的路径称为数据通路，由控制部件控制。路径上的部件称为数据通路部件。</li>
</ul>
</li>
</ul>
<h3 id="基本结构-1"><a href="#基本结构-1" class="headerlink" title="基本结构"></a>基本结构</h3><ul>
<li><p>CPU内部单总线方式</p>
<ul>
<li><p>同一时刻只允许两个部件进行数据交换</p>
<ul>
<li>移位寄存器上方可加一个控制部件三态门，判断此刻它是否可以发给总线</li>
</ul>
</li>
</ul>
</li>
<li><p>CPU内部三总线方式</p>
<ul>
<li>有多少总线就有多少组交换</li>
</ul>
</li>
<li><p>专用数据通路方式</p>
<ul>
<li>两个寄存器单独接线，避免使用共享总线，性能高，硬件量大</li>
</ul>
</li>
</ul>
<h3 id="数据传送"><a href="#数据传送" class="headerlink" title="数据传送"></a>数据传送</h3><ul>
<li><p>各寄存器之间</p>
<ul>
<li>PC→Bus PCout有效，PC内容送总线（控制信号） Bus→MAR MARin有效，总线内容送MAR</li>
</ul>
</li>
<li><p>主存和CPU之间</p>
<ul>
<li>PC→Bus→MAR PCout和MARin有效，现行指令地址送MAR 1→R（微命令）    CU发读指令                                            MEM(MAR)→MDR MDRinE有效(微操作 )                           MDR→Bus→IR  MDRout和IRin有效，现行指令送IR</li>
</ul>
</li>
<li><p>执行算术或逻辑运算</p>
<ul>
<li>AD(IR)→Bus→MAR  MDRout和MARin有效 1→R                      CU发读命令                                MEM→数据线→MDR  MDRinE有效              MDR→Bus→Y   MDRin和Yin有效，操作数→Y<br>(ACC)+(Y)→Z    ACCout和ALUin有效，CU发加<br>                   指令，结果→Z                           Z→ACC                Zout和ACCin有效，结果→ACC</li>
</ul>
</li>
</ul>
<h2 id="控制器的功能和工作原理"><a href="#控制器的功能和工作原理" class="headerlink" title="控制器的功能和工作原理"></a>控制器的功能和工作原理</h2><h3 id="控制器功能"><a href="#控制器功能" class="headerlink" title="控制器功能"></a>控制器功能</h3><ul>
<li>从主存中取出一条指令，并指出下一条指令位置</li>
<li>对指令进行译码或测试，产生相应的操作控制信号，以便启动规定动作</li>
<li>指挥并控制数据流动方向（CPU、主存、I&#x2F;O之间）</li>
</ul>
<h3 id="微命令"><a href="#微命令" class="headerlink" title="微命令"></a>微命令</h3><ul>
<li><p>微操作（计算机中最基本的不可再分解的操作）的控制信号</p>
<ul>
<li><p>相容性微命令</p>
<ul>
<li>可以同时产生、共同完成某一些微操作的微命令</li>
</ul>
</li>
<li><p>互斥性微命令</p>
<ul>
<li>不允许同时出现的微命令</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="硬布线控制器"><a href="#硬布线控制器" class="headerlink" title="硬布线控制器"></a>硬布线控制器</h3><ul>
<li><p>由逻辑门电路和触发器构成</p>
<ul>
<li>节拍发生器每个脉冲激活一条线，判断处于第几个节拍；一个微命令对应一根输出线（Cn)。硬布线控制器的时序系统较复杂</li>
</ul>
</li>
<li><p>设计步骤</p>
<ul>
<li><p>分析每个阶段的微操作序列（取值、间址、执行（主要是这个）、中断）</p>
</li>
<li><p>选择CPU的控制方式</p>
<ul>
<li><p>定长还是不定长机器周期，每个周期安排几个节拍（如3）</p>
<ul>
<li><p>同步控制方式</p>
<ul>
<li><p>有统一的时钟</p>
<ul>
<li>控制电路简单，运行慢</li>
</ul>
</li>
</ul>
</li>
<li><p>异步控制方式</p>
<ul>
<li>不存在基准时标信号，按自身固有速度工作</li>
</ul>
</li>
<li><p>联合控制方式</p>
<ul>
<li>大部分采用同步，小部分采用异步</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>安排微操作时序</p>
<ul>
<li><p>如何在3个节拍内完成整个机器周期所有微操作</p>
<ul>
<li>原则一 微操作的先后顺序不可更改</li>
<li>二 被控对象不同的安排在同一节拍</li>
<li>三 占用时间短的安排在一个节拍内完成</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>（快的一次多做点）</p>
<ul>
<li><p>电路设计</p>
<ul>
<li><p>确定每个微命令的逻辑表达式，并用电路实现</p>
<ul>
<li>列出微操作时间表</li>
<li>写出微命令的最简表达式</li>
<li>画出逻辑图</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="微程序控制器"><a href="#微程序控制器" class="headerlink" title="微程序控制器"></a>微程序控制器</h3><ul>
<li><p>采用存储逻辑实现，每条机器指令转化为一段微程序存入控制存储器中</p>
<ul>
<li>指令系统有n条指令，C M中有n+2条，（1条公共取值微程序，1个中断周期微程序）</li>
</ul>
</li>
<li><p>微指令的设计</p>
<ul>
<li><p>水平型微指令</p>
<ul>
<li><p>一条微指令能定义多个可并行微命令</p>
<ul>
<li>操作控制（见编码方式）|顺序控制（下地址）</li>
</ul>
</li>
<li><p>操作码字段长；微程序短，执行速度快；微指令长，编写麻烦</p>
</li>
</ul>
</li>
<li><p>垂直型微指令</p>
<ul>
<li><p>一条只能定义一个</p>
<ul>
<li>μOP微操作码|Rd目的地址|Rs源地址</li>
</ul>
</li>
<li><p>操作码字段短；微程序长，执行速度慢，工作效率低；微指令短、规整，编写简单</p>
</li>
</ul>
</li>
<li><p>混合型微指令</p>
<ul>
<li>在垂直型上增加一些简单的并行操作</li>
</ul>
</li>
</ul>
</li>
<li><p>编码方式  (水平型) </p>
<ul>
<li><p>直接编码（控制）方式</p>
<ul>
<li><p>每位代表一个微操作命令</p>
<ul>
<li>无需译码，简单，执行速度快，并行性好；微指令字长过长</li>
</ul>
</li>
</ul>
</li>
<li><p>字段直接编码</p>
<ul>
<li><p>将操控分成若干小字段，把互斥性微命令组合在同一字段，相容性在不同段；每个字段单独编码译码，信息位不能太多；每段留一个状态(000)代表不发出微命令</p>
<ul>
<li>缩短指令字长，需要译码，速度慢</li>
</ul>
</li>
</ul>
</li>
<li><p>字段间接编码（隐式编码）</p>
<ul>
<li><p>一个字段的微命令需由另一字段的某些微指令来解释，可缩短字长，但削弱并行能力，作为直接的辅助</p>
<ul>
<li>再缩，更慢</li>
</ul>
</li>
</ul>
</li>
<li><p>混合编码</p>
<ul>
<li>以上三种混合使用</li>
</ul>
</li>
</ul>
</li>
<li><p>地址形成方式</p>
<ul>
<li><p><strong>下地址字段直接指出，断定方式</strong></p>
</li>
<li><p>由机器指令的操作码经微地址形成部件形成</p>
</li>
<li><p><strong>增量计数法</strong></p>
<ul>
<li>（CMAR）+1→CMAR(同PC)</li>
</ul>
</li>
<li><p>分支转移</p>
<ul>
<li>操作字段|转移方式|转移地址</li>
</ul>
</li>
<li><p>通过测试网络</p>
<ul>
<li>硬件</li>
</ul>
</li>
<li><p>微程序入口地址由指令操作码字段给出</p>
</li>
<li><p>由硬件产生微程序入口地址</p>
<ul>
<li>专门硬件记录取值周期微程序首地址</li>
</ul>
</li>
</ul>
</li>
<li><p>设计步骤</p>
<ul>
<li>分析每个阶段的微操作序列（结尾比硬布线多一条 Ad(CMDR)→CMAR，一个节拍，为了得到下一指令地址,其余相同）</li>
<li>写出对应机器指令的微命令及节拍安排</li>
<li>确定微指令格式</li>
<li>编写微指令码点，操控字段每位代表的微命令</li>
</ul>
</li>
<li><p>分类</p>
<ul>
<li><p>动态微程序设计</p>
<ul>
<li>采用EPROM，能根据用户的要求改变微程序</li>
</ul>
</li>
<li><p>毫微程序设计</p>
<ul>
<li>硬件由第二级控制存储器中的毫微程序直接控制</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="异常和中断机制"><a href="#异常和中断机制" class="headerlink" title="异常和中断机制"></a>异常和中断机制</h2><h3 id="异常和中断的基本概念"><a href="#异常和中断的基本概念" class="headerlink" title="异常和中断的基本概念"></a>异常和中断的基本概念</h3><ul>
<li>异常是控制流中的突变，用来相应处理机状态中的某些变化</li>
</ul>
<h3 id="异常和中断的分类"><a href="#异常和中断的分类" class="headerlink" title="异常和中断的分类"></a>异常和中断的分类</h3><p>- </p>
<h3 id="异常和中断的检测与响应"><a href="#异常和中断的检测与响应" class="headerlink" title="异常和中断的检测与响应"></a>异常和中断的检测与响应</h3><h2 id="指令流水线"><a href="#指令流水线" class="headerlink" title="指令流水线"></a>指令流水线</h2><h3 id="执行方式"><a href="#执行方式" class="headerlink" title="执行方式"></a>执行方式</h3><ul>
<li><p>顺序(串行)执行方式</p>
<ul>
<li><p>前一条执行完才启动下一条，T&#x3D;3nt</p>
<ul>
<li>控制简单，硬件代价小；执行指令的速度慢，利用率低</li>
</ul>
</li>
</ul>
</li>
<li><p>一次重叠执行方式</p>
<ul>
<li><p>第k条的执行阶段和第k+1条取值阶段同时进行，T&#x3D;(1+2n)t——一共取值、分析、执行三个阶段</p>
<ul>
<li>利用率提高，速度快；硬件开销大</li>
</ul>
</li>
</ul>
</li>
<li><p>二次重叠执行方式</p>
<ul>
<li>第k条的分析阶段和第k+1条取值阶段同时进行，T&#x3D;(2+n)t</li>
</ul>
</li>
</ul>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><ul>
<li><p>1</p>
<ul>
<li><p>部件功能级流水线</p>
<ul>
<li><p>处理机部件内部</p>
<ul>
<li>加法、求阶差、对阶、尾数相加</li>
</ul>
</li>
</ul>
</li>
<li><p>处理机级流水线</p>
<ul>
<li><p>处理机内部</p>
<ul>
<li>取值、译码、执行</li>
</ul>
</li>
</ul>
</li>
<li><p>处理机间流水线</p>
<ul>
<li><p>处理机作为整体</p>
<ul>
<li>一个CPU完成一种工作</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>2</p>
<ul>
<li>单功能、多功能</li>
</ul>
</li>
<li><p>3</p>
<ul>
<li><p>动态流水线</p>
<ul>
<li>同一时间内不同段可以进行不同运算</li>
</ul>
</li>
<li><p>静态流水线</p>
<ul>
<li>同一时间内各段只能按同一种功能的连接方式工作</li>
</ul>
</li>
</ul>
</li>
<li><p>4</p>
<ul>
<li><p>线性流水线</p>
<ul>
<li>从输入到输出，每个功能段只允许经过一次</li>
</ul>
</li>
<li><p>非线性流水线</p>
<ul>
<li>存在反馈回路，适合进行递归运算</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="性能指标"><a href="#性能指标" class="headerlink" title="性能指标"></a>性能指标</h3><ul>
<li><p>吞吐率</p>
<ul>
<li><p>单位时间内流水线所完成的任务数量</p>
<ul>
<li>Tp&#x3D;n&#x2F;Tk&#x3D;n&#x2F;(k+n-1)Δt</li>
<li>n-任务数，Tk-处理完n个任务所需时间，k-一条指令分k个阶段，Δt-每阶段耗时</li>
<li>n→∞, Tp max&#x3D;1&#x2F;Δt</li>
</ul>
</li>
</ul>
</li>
<li><p>加速比</p>
<ul>
<li><p>不用流水线和使用流水线所用时间之比</p>
<ul>
<li>S&#x3D;T0&#x2F;Tk&#x3D;kn&#x2F;k+n-1</li>
<li>n→∞, S max&#x3D;k</li>
</ul>
</li>
</ul>
</li>
<li><p>效率</p>
<ul>
<li><p>设备利用率</p>
<ul>
<li>E&#x3D;T0&#x2F;kTk</li>
<li>n→∞,E max&#x3D;1</li>
</ul>
</li>
</ul>
</li>
<li><p>处理机的度</p>
<ul>
<li>常规的标量流水线单处理机是在每个Δt期间解释完一条指令，称这种流水机的度m&#x3D;1。</li>
</ul>
</li>
</ul>
<p>超标量处理机采用多指令流水线，每个Δt同时流出m条指令，称度为m。</p>
<h3 id="影响因素"><a href="#影响因素" class="headerlink" title="影响因素"></a>影响因素</h3><ul>
<li><p>结构相关（资源冲突）</p>
<ul>
<li><p>多条指令在同一时刻争用统一资源</p>
<ul>
<li>解决方法：                  后一指令暂停一周期</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> 资源重复配置 </p>
<ul>
<li><p><strong>数据相关（数据冲突）</strong></p>
<ul>
<li><p>必须前一指令执行完才能执行后一条指令(进位)</p>
<ul>
<li>将后续指令暂停几周期，硬件阻塞(stall)和软件插入”NOP”</li>
<li>数据旁路技术，设置直接传送结果的通路，不用再写回寄存器</li>
<li>编译优化</li>
</ul>
</li>
<li><p>“按序发射，按序完成“的流水线只会发生RAW相关</p>
</li>
</ul>
</li>
<li><p>控制相关（控制冲突)</p>
<ul>
<li><p>逻辑转移指令和其他改变PC值的指令造成断流</p>
<ul>
<li><p>分支预测</p>
<ul>
<li><p>简单预测</p>
<ul>
<li>预测不满足</li>
</ul>
</li>
<li><p>动态预测</p>
<ul>
<li>根据历史调整</li>
</ul>
</li>
</ul>
</li>
<li><p>预期转移成功和不成功两个方向的目标指令</p>
</li>
<li><p>加快和提前形成条件码</p>
</li>
<li><p>提高转移方向猜准率</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="多发技术"><a href="#多发技术" class="headerlink" title="多发技术"></a>多发技术</h3><ul>
<li><p>超标量技术（空分复用）</p>
<ul>
<li><p>一次同时运行多条指令</p>
<ul>
<li>要配置多个功能部件，不能调整执行顺序</li>
</ul>
</li>
</ul>
</li>
<li><p>超流水技术（时分复用）</p>
<ul>
<li><p>在同一时钟周期内再分段、第二段开始重叠，一个时钟周期内可启动多条</p>
<ul>
<li>一个功能部件使用多次 ，不能调整</li>
</ul>
</li>
</ul>
</li>
<li><p>超长指令字</p>
<ul>
<li><p>把多条能并行的指令组合成一条</p>
<ul>
<li>需要多个处理部件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="多处理器的基本概念"><a href="#多处理器的基本概念" class="headerlink" title="多处理器的基本概念"></a>多处理器的基本概念</h2><h3 id="SISD、SIMD、MIMD、向量处理器的基本概念"><a href="#SISD、SIMD、MIMD、向量处理器的基本概念" class="headerlink" title="SISD、SIMD、MIMD、向量处理器的基本概念"></a>SISD、SIMD、MIMD、向量处理器的基本概念</h3><ul>
<li><p>SISD</p>
<ul>
<li><p>单指令流单数据流结构</p>
<ul>
<li>传统串行计算机结构，仅包含一个处理器和一个存储器</li>
</ul>
</li>
</ul>
</li>
<li><p>SIMD</p>
<ul>
<li><p>单指令流多数据流</p>
<ul>
<li><p>数据级并行技术，有1个指令控制部件和多个处理单元组成。每个处理单元有不同的数据地址，处理不同数据</p>
<ul>
<li>使用for循环处理数组时最有效</li>
<li>case和switch语句最低效</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>MISD</p>
<ul>
<li><p>多指令流单数据流结构</p>
<ul>
<li>同时执行多条指令处理同一个数据，不存在</li>
</ul>
</li>
</ul>
</li>
<li><p>MIMD</p>
<ul>
<li><p>多指令流多数据流</p>
<ul>
<li><p>同时执行多条指令处理多个数据</p>
<ul>
<li><p>多计算机系统</p>
<ul>
<li>每个计算机节点有各自的私有存储器，通过消息传递进行数据传送，也称为消息传递MIMD</li>
</ul>
</li>
<li><p>多处理器系统</p>
<ul>
<li>共享存储多处理器系统SMP，具有共享地址空间，也称为共享存储MIMD</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>向量处理器</p>
<ul>
<li><p>SIMD的变种</p>
<ul>
<li><p>实现直接操作一维数组（向量）的指令集</p>
<ul>
<li>在数值模拟领域极大提升性能</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="硬件多线程的基本概念"><a href="#硬件多线程的基本概念" class="headerlink" title="硬件多线程的基本概念"></a>硬件多线程的基本概念</h3><ul>
<li><p>减少线程切换开销</p>
<ul>
<li><p>细粒度多线程</p>
<ul>
<li>多个线程之间轮流交叉执行指令，指令不相关，可以乱序并行执行</li>
</ul>
</li>
<li><p>粗粒度多线程</p>
<ul>
<li>仅在一个线程出现了较大开销的阻塞时才切换线程，新线程执行前需重载流水线，切换开销大</li>
</ul>
</li>
<li><p>同时多线程SMT</p>
<ul>
<li>&#x3D;超线程，实现指令级并行的同时实现线程级并行</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="多核处理器的基本概念"><a href="#多核处理器的基本概念" class="headerlink" title="多核处理器的基本概念"></a>多核处理器的基本概念</h3><ul>
<li><p>将多个处理单元集成到单个CPU中，每个处理单元成为一个核，所有核对称并共享主存储器</p>
<ul>
<li>多核的线程才是真正的并行执行</li>
</ul>
</li>
</ul>
<h3 id="共享内存多处理器的基本概念"><a href="#共享内存多处理器的基本概念" class="headerlink" title="共享内存多处理器的基本概念"></a>共享内存多处理器的基本概念</h3><ul>
<li><p>具有共享的单一物理地址空间的多处理器，仍可以在自己的虚拟地址空间单独运行程序</p>
<ul>
<li><p>统一存储访问多处理器</p>
<ul>
<li>访问时间大致相同</li>
</ul>
</li>
<li><p>非统一存储访问多处理器</p>
<ul>
<li><p>某些访存请求会更快，取决于哪个处理器提出和访问哪个字</p>
<ul>
<li><p>NC-NUMA</p>
<ul>
<li>不带Cache</li>
</ul>
</li>
<li><p>CC-NUMA</p>
<ul>
<li>带一致性cache</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  
</article>
    </main>
    <footer id="footer">
  Copyright &copy;
  2022
  BONE
  
  
    <a class="social-links" target="_blank" rel="noopener" href="https://github.com/FloatinDLE"><i class="blogfont">&#xe6b7; </i></a>
  
    <a class="social-links" href="mailto:bone_n@foxmail.com"><i class="blogfont">&#xe61a; </i></a>
  
    <a class="social-links" href="/atom.xml"><i class="blogfont">&#xe640; </i></a>
  
  
</footer>
    <!-- scripts -->

<script src="/scripts/main.js"></script>

  </body>
</html>