<!DOCTYPE html>
<html  lang=en>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  
    
    <link rel="shortcut icon" href="/images/kou.ico ">
    
    
    <link rel="icon" type="image/png" href="/images/favicon-android.png " sizes="192x192">
    
    
    <link rel="apple-touch-icon" href="/images/favicon-apple.png " sizes="180x180">
    
  
  <!-- title -->
  <title>地下室 总线和输入输出系统 </title>
  <!-- styles -->
  <!-- styles -->

<link rel="stylesheet" href="/styles/global.css">

  <!-- rss -->
  
<meta name="generator" content="Hexo 5.4.1"></head>
  <body>
    <header id="header">
  
  <nav class="menu menu--right">
  
    <a class="menu__item" href="/">主页</a>
    <a class="menu__item" href="/archives/">归档</a>
    <a class="menu__item" href="/categories/">专题</a>
    <a class="menu__item" href="/tags/">标签</a>
    <!-- <a class="menu__item" href="/">作品</a> -->
    <!-- <a class="menu__item" href="/about/">关于</a> -->
  </nav>
</header>
    <main>
      <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post__header">
  <h1 class="post__title">总线和输入输出系统</h1>
  
  
  <div class="post__meta">
    
<time class="post__date" datetime="2022-01-08T01:43:25.000Z" itemprop="datePublished">
  
  <i class="blogfont">&#xedff;</i>
  
  2022-01-08 09:43:25
</time>

    
<div class="post__category">
  <i class="blogfont">&#xe62d;</i>
  <a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">计算机组成原理</a>
</div>
  

    

    <div id="/2022/01/08/%E6%80%BB%E7%BA%BF%E5%92%8C%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/" class="leancloud_visitors post__stat" data-flag-title="总线和输入输出系统">
  <i class="blogfont">&#xe672;</i>
  <span class="leancloud-visitors-count">loading...</span>
</div>
  </div>
</header>
  <aside class="post__aside">
  <div class="post__actions">
    <a id="backTop" class="post__top" href="javascript:">
      <i class="blogfont">&#xe6b1;</i><!-- Top -->
    </a>
    <a id="share" class="post__share" href="javascript:">
      <i class="blogfont">&#xe6c1;</i>
    </a>
  </div>
  <ol class="post__toc"><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#%E6%80%BB%E7%BA%BF%E6%A6%82%E8%BF%B0"><span class="post__toc-text">总线概述</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="post__toc-text">定义</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E5%88%86%E7%B1%BB"><span class="post__toc-text">分类</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E7%BB%93%E6%9E%84"><span class="post__toc-text">结构</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87"><span class="post__toc-text">性能指标</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%80%BB%E7%BA%BF%E4%BB%B2%E8%A3%81"><span class="post__toc-text">总线仲裁</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%80%BB%E7%BA%BF%E4%BA%8B%E5%8A%A1"><span class="post__toc-text">总线事务</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%80%BB%E7%BA%BF%E5%AE%9A%E6%97%B6"><span class="post__toc-text">总线定时</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86"><span class="post__toc-text">总线标准</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#I-x2F-O%E6%8E%A5%E5%8F%A3%EF%BC%88%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%89"><span class="post__toc-text">I&#x2F;O接口（控制器）</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#I-x2F-O%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="post__toc-text">I&#x2F;O接口的功能和基本结构</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#I-x2F-O%E7%AB%AF%E5%8F%A3%E5%8F%8A%E5%85%B6%E7%BC%96%E5%9D%80"><span class="post__toc-text">I&#x2F;O端口及其编址</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#I-x2F-O%E6%96%B9%E5%BC%8F"><span class="post__toc-text">I&#x2F;O方式</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E7%A8%8B%E5%BA%8F%E6%9F%A5%E8%AF%A2%E6%96%B9%E5%BC%8F"><span class="post__toc-text">程序查询方式</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%96%AD%E6%96%B9%E5%BC%8F"><span class="post__toc-text">程序中断方式</span></a></li></ol></li><li class="post__toc-item post__toc-level-2"><a class="post__toc-link" href="#DMA%E6%96%B9%E5%BC%8F"><span class="post__toc-text">DMA方式</span></a><ol class="post__toc-child"><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#DMA%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E7%BB%84%E6%88%90"><span class="post__toc-text">DMA控制器的组成</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#DMA%E4%BC%A0%E9%80%81%E8%BF%87%E7%A8%8B"><span class="post__toc-text">DMA传送过程</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#DMA%E4%BC%A0%E9%80%81%E6%96%B9%E5%BC%8F"><span class="post__toc-text">DMA传送方式</span></a></li><li class="post__toc-item post__toc-level-3"><a class="post__toc-link" href="#I-x2F-O%E5%92%8C%E4%B8%BB%E6%9C%BA%E5%B9%B6%E8%A1%8C%E5%B7%A5%E4%BD%9C%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%92%8C%E4%BC%A0%E9%80%81%E5%B9%B6%E8%A1%8C%E5%B7%A5%E4%BD%9C"><span class="post__toc-text">I&#x2F;O和主机并行工作，程序和传送并行工作</span></a></li></ol></li></ol>
</aside>
  <div class="post__content" itemprop="articleBody">
    <h2 id="总线概述"><a href="#总线概述" class="headerlink" title="总线概述"></a>总线概述</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li><p>一组能为多个部件分时（一个发送）共享（多个接收）的公共信息传送线路（几根并行几bit）</p>
<ul>
<li><p>机械特性</p>
<ul>
<li>尺寸、形状、管脚数、排列顺序</li>
</ul>
</li>
<li><p>电气特性</p>
<ul>
<li>传输方向（地址：CPU→主存→硬盘 数据：双向  控制：CPU→主存）、有效电平范围（高、低）</li>
</ul>
</li>
<li><p>功能特性</p>
<ul>
<li>每根线的功能（数据、地址、控制）</li>
</ul>
</li>
<li><p>时间特性</p>
<ul>
<li>信号时序关系</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><ul>
<li><p>按传输格式</p>
<ul>
<li><p>并行传输总线</p>
<ul>
<li><p>多位一起传</p>
<ul>
<li>简单、成本高、占空间、有干扰、速度不快、频率不能高</li>
</ul>
</li>
</ul>
</li>
<li><p>串行传输总线</p>
<ul>
<li><p>1bit1bit传</p>
<ul>
<li>成本低、应用于长路、抗干扰能力强、节省空间</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>按总线连接部件不同</p>
<ul>
<li><p>片内总线</p>
<ul>
<li><p>CPU内部</p>
<ul>
<li>连接CPU与北桥、主存</li>
</ul>
</li>
</ul>
</li>
<li><p>系统总线</p>
<ul>
<li><p>CPU、主存、I&#x2F;O接口</p>
<ul>
<li>与北桥芯片（快）相连</li>
</ul>
</li>
</ul>
</li>
<li><p>通信总线</p>
<ul>
<li><p>计算机之间（网线）</p>
<ul>
<li>与南桥芯片（慢）相连</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>按时序控制</p>
<ul>
<li>同步、异步</li>
</ul>
</li>
</ul>
<h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><ul>
<li><p>单总线结构</p>
<p>  - </p>
<pre><code>  -  一根总线内含多根信号线（DB、AB、CB）
  - 简单，成本低，易纳新；带宽低、负载重、不支持并发、传输效率不匹配、浪费性能
</code></pre>
</li>
<li><p>双总线结构</p>
<p>  - </p>
<pre><code>  - 通道：小CPU，主存总线支持突发（猝发）传送，送出一个首地址就能收到连续几个地址的数据。
</code></pre>
</li>
<li><p>三总线结构</p>
<p>  - </p>
<pre><code>  - DMA连接主存和外设，提高吞吐量，提升高速I/O设备性能，响应比慢于双总线，效率低
</code></pre>
</li>
<li><p>四总线结构</p>
<ul>
<li><ul>
<li><p>速度：局部（CPU）&gt;系统&gt;高速&gt;扩展。桥接器用于数据缓冲。</p>
<ul>
<li>局部总线为了节省系统总带宽</li>
</ul>
</li>
<li><p>在主板上主要有两大主要部分：北桥和南桥。北桥主要负责CPU和内存、显卡这些部件的数据传送，而南桥主要负责I&#x2F;O设备、外部存储设备以及BIOS之间的通信。</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="性能指标"><a href="#性能指标" class="headerlink" title="性能指标"></a>性能指标</h3><ul>
<li><p>传输周期（总线周期）</p>
<ul>
<li>一次总线操作操作所需时间，包括申请阶段（传输请求、总线仲裁）、寻址阶段、传输阶段、结束阶段（从总线上撤销有关信息）</li>
<li>总线宽度为32bit，则一总线周期传输32bit数据</li>
</ul>
</li>
<li><p>总线时钟周期</p>
<ul>
<li>即机器周期，与计算机统一，也有可能由桥接器提供</li>
<li>1个总线周期一般包括多个时钟周期，也有可能1:1 or n:1（上升沿一次下降沿一次）</li>
</ul>
</li>
<li><p>工作频率</p>
<ul>
<li>总线周期的倒数，一秒内传几次数据</li>
</ul>
</li>
<li><p>时钟频率</p>
<ul>
<li>时钟周期的倒数，一秒内有多少个时钟周期</li>
</ul>
</li>
<li><p>总线宽度</p>
<ul>
<li>&#x3D;总线位宽，通常指数据总线的宽度</li>
</ul>
</li>
<li><p>总线带宽</p>
<ul>
<li><p>数据传输率，单位时间内总线上可传输数据位数（B&#x2F;s)。</p>
<ul>
<li>总线带宽&#x3D;工作频率×宽度&#x3D;总线宽度&#x2F;总线周期</li>
</ul>
</li>
</ul>
</li>
<li><p>总线复用</p>
<ul>
<li>数据线和地址线复用，用同一总线分时传送数据。节省空间成本。</li>
</ul>
</li>
<li><p>信号线数</p>
<ul>
<li>DB+AB+CB的线数和</li>
</ul>
</li>
</ul>
<h3 id="总线仲裁"><a href="#总线仲裁" class="headerlink" title="总线仲裁"></a>总线仲裁</h3><ul>
<li><p>定义</p>
<ul>
<li><p>多个主设备同时竞争总线控制权，选择一个主设备优先获得控制权叫仲裁</p>
<ul>
<li><p>主设备</p>
<ul>
<li>获得总线控制权的设备</li>
</ul>
</li>
<li><p>从设备</p>
<ul>
<li>被主设备访问，只能响应</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>分类</p>
<ul>
<li><p>集中仲裁方式</p>
<ul>
<li><p>链式查询方式</p>
<ul>
<li>按顺序分配，+BG,BR,BS三根线</li>
<li>向BR发送高电平信号→BG发1，第一个接收到并且想使用的获得使用权→设备向BS发1，BG变0→设备发送数据</li>
<li>离总线控制器越近的设备优先级越高（固定），总线忙由获得控制权的设备发出</li>
<li>优先权固定、结构简单、扩充容易；单一故障影响大、优先级低的设备用不到</li>
</ul>
</li>
<li><p>计时器定时查询方式</p>
<ul>
<li>计数器自加，地址与计数器值相同的设备获权</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> +计数器，设备地址线一组,BR，BS（无BG） n个设备大致「㏒₂n]+2条线<br>            - 向BR发1→计数器开始计数，若计数器值与设备地址（编号）相同且BR&#x3D;1则该设备获权否则计数器+1→设备向BS发1，仲裁结束，撤销BG→设备使用完，撤销BS，进行下一次仲裁<br>            - 设置计数器初始值可改变设备优先级（为0则是链式），每次从上次终点开始，由程序设置。<br>            - 对故障不再敏感，控制线数增加</p>
<pre><code>    - 独立请求方式

        - 排队器决定谁用；+排队器，每个设备一对BRi和BGi，始终置1的BS（共2n+1条线）
        - 向BR发1→排队器决定让那个设备获权→设备向BS发1，仲裁结束，撤销BG→设备使用完，撤销BS，进行下一次仲裁
        - 响应速度快、优先级灵活；控制线数量最多、逻辑复杂

- 分布仲裁方式

    - 每个主模块都有自己的仲裁器和仲裁号
    - 把各自仲裁号发送到仲裁总线→从仲裁总线上得到的仲裁号与自己比较，优先级高于仲裁号者留在仲裁总线上
</code></pre>
<h3 id="总线事务"><a href="#总线事务" class="headerlink" title="总线事务"></a>总线事务</h3><ul>
<li><p>从请求总线到完成总线使用的操作序列。在一个总线周期中发生</p>
<ul>
<li><p>请求阶段</p>
<ul>
<li>主设备（CPU或DMA）发出总线传输请求，并获得总线控制权</li>
</ul>
</li>
<li><p>仲裁阶段</p>
<ul>
<li>总线仲裁机构将下一传输周期的总线使用权赋予某一申请者</li>
</ul>
</li>
<li><p>寻址阶段</p>
<ul>
<li>主设备通过总线给出的从设备地址和命令，启动从模块</li>
</ul>
</li>
<li><p>传输阶段</p>
<ul>
<li>主从模块进行数据交换</li>
</ul>
</li>
<li><p>释放阶段</p>
<ul>
<li>主模块有关信息均从系统总线上撤除，让出总线使用权</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="总线定时"><a href="#总线定时" class="headerlink" title="总线定时"></a>总线定时</h3><ul>
<li><p>定义</p>
<ul>
<li>总线在双方交换数据过程中需时间上配合关系的控制，实质是一种协议或规则</li>
</ul>
</li>
<li><p>分类</p>
<ul>
<li><p>同步通信（同步定时方式）</p>
<ul>
<li><p>由统一时钟控制</p>
<ul>
<li><p>一个总线周期进行一次数据交换</p>
<ul>
<li>速度高、逻辑简单；主从强制性同步、不能及时检验、可靠性差。适用于总线长度较短和部件存取时间接近的系统</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>异步通信</p>
<ul>
<li><p>采用应答方式，没有公共时钟</p>
<ul>
<li><p>主设备发请求，从设备发回答</p>
<ul>
<li><p>总线周期长度可变；慢、复杂</p>
<ul>
<li><p>不互锁方式</p>
<ul>
<li>请求不必等回答，过一段时间自动撤销请求；回答也自动撤销</li>
</ul>
</li>
<li><p>半互锁方式</p>
<ul>
<li>请求必须等回答，才撤销请求；回答自动撤销</li>
</ul>
</li>
<li><p>全互锁方式</p>
<ul>
<li>请求必须等回答，才撤销请求；回答获知请求撤销后撤销</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>半同步通信</p>
<ul>
<li><p>同步、异步结合</p>
<ul>
<li>在统一时钟的基础上，增加一个“等待”信号，从设备没准备好时发等待让主设备等几个周期</li>
</ul>
</li>
</ul>
</li>
<li><p>分离式通信</p>
<ul>
<li><p>充分发掘总线潜力</p>
<ul>
<li><p>把总线周期分为</p>
<ul>
<li><p>子周期1</p>
<ul>
<li>主申请占用总线，使用完后放弃</li>
</ul>
</li>
<li><p>子周期2</p>
<ul>
<li>从申请，将信息送至总线</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="总线标准"><a href="#总线标准" class="headerlink" title="总线标准"></a>总线标准</h3><ul>
<li><p><strong>ISA</strong></p>
<ul>
<li><p>并行</p>
<ul>
<li><p>8&#x2F;16bit</p>
<ul>
<li>系统总线</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>EISA</strong></p>
<ul>
<li><p>并行</p>
<ul>
<li><p>32bit</p>
<ul>
<li>系统总线</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>VESA</p>
<ul>
<li><p>并行</p>
<ul>
<li><p>32bit</p>
<ul>
<li><p>局部总线</p>
<ul>
<li>传送活动图像（视频），工作频率受CPU控制，跟不上</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>PCI</strong></p>
<ul>
<li><p>并行</p>
<ul>
<li><p>32&#x2F;64bit</p>
<ul>
<li><p>局部&#x2F;系统总线</p>
<ul>
<li>外部设备互连，不依附于处理器，热插拔（即插即用）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>AGP</p>
<ul>
<li><p>并行</p>
<ul>
<li><p>局部总线</p>
<ul>
<li>基于PCI的扩充修改，加速图形接口</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>PCI-E</strong></p>
<ul>
<li><p><strong>串行</strong></p>
<ul>
<li><p>速度10GB&#x2F;s以上</p>
<ul>
<li><p>局部总线</p>
<ul>
<li>第三代I&#x2F;O技术，点对点连接，全双工模式（双向传输）。取代PCI和AGP的最终标准</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>RS-232C</p>
<ul>
<li><p>串行</p>
<ul>
<li><p>速度20kbit&#x2F;s</p>
<ul>
<li><p>通信总线</p>
<ul>
<li>连针式打印机</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>SCSI</p>
<ul>
<li><p>并行</p>
<ul>
<li><p>设备总线（&#x3D;通信总线）</p>
<ul>
<li>连高速I&#x2F;O设备（激光打印机，光驱等）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>PCMCIA</p>
<ul>
<li><p>并行</p>
<ul>
<li><p>设备总线</p>
<ul>
<li><p>连存储卡（PC卡），热插拔</p>
<ul>
<li>电脑上的卡槽</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>USB</strong></p>
<ul>
<li><p>串行</p>
<ul>
<li><p>设备总线</p>
<ul>
<li><p>typeA&#x2F;B&#x2F;C，外面两个长脚接电，中间两根短脚为抗干扰强的差模信号，合起来传送1bit</p>
<ul>
<li>热插拔；菊花链（1个可接127个）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>IDE(ATA)</p>
<ul>
<li><p>并行</p>
<ul>
<li><p>设备总线</p>
<ul>
<li>连硬盘</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>SATA</p>
<ul>
<li><p>串行</p>
<ul>
<li><p>设备总线</p>
<ul>
<li>连硬盘</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="I-x2F-O接口（控制器）"><a href="#I-x2F-O接口（控制器）" class="headerlink" title="I&#x2F;O接口（控制器）"></a>I&#x2F;O接口（控制器）</h2><h3 id="I-x2F-O接口的功能和基本结构"><a href="#I-x2F-O接口的功能和基本结构" class="headerlink" title="I&#x2F;O接口的功能和基本结构"></a>I&#x2F;O接口的功能和基本结构</h3><ul>
<li><p>基本概念</p>
<ul>
<li><p>I&#x2F;O接口&#x3D;I&#x2F;O控制器&#x3D;设备控制器：内含几个I&#x2F;O端口（读&#x2F;写寄存器）的芯片，负责协调主机与外设间的数据传输，集成在主板或南桥芯片上</p>
<ul>
<li><p>I&#x2F;O系统包括</p>
<ul>
<li><p>I&#x2F;O硬件</p>
<ul>
<li>外设、I&#x2F;O接口、I&#x2F;O总线</li>
</ul>
</li>
<li><p>I&#x2F;O软件</p>
<ul>
<li>驱动程序、用户程序、管理程序、升级补丁</li>
<li>驱动程序用设备厂家设计</li>
<li>采用I&#x2F;O指令（CPU执行）和通道指令（通道执行）实现主机与I&#x2F;O的信息交交换</li>
<li>操作码（识别I&#x2F;O指令|命令码（具体操作）|设备码（哪个设备）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>功能</p>
<ul>
<li><p>数据缓冲</p>
<ul>
<li>设置数据缓冲寄存器，实现主机和外设工作速度的匹配</li>
</ul>
</li>
<li><p>错误或状态监测</p>
<ul>
<li>通过状态寄存器反馈设备信息供CPU查看</li>
</ul>
</li>
<li><p>控制和定时</p>
<ul>
<li>接收从控制总线发来的控制信号、时钟信号</li>
</ul>
</li>
<li><p>串行→并行，并行→串行的转换</p>
</li>
<li><p>实现主机与I&#x2F;O设备的通信</p>
</li>
</ul>
</li>
<li><p>基本结构</p>
<p>  - </p>
</li>
<li><p>I&#x2F;O控制方式</p>
<ul>
<li>程序查询方式</li>
<li>程序中断方式</li>
<li>DMA方式</li>
<li>通道方式</li>
</ul>
</li>
<li><p>类型</p>
<ul>
<li><p>数据传送方式</p>
<ul>
<li>并行接口</li>
<li>串行接口</li>
</ul>
</li>
<li><p>控制方式</p>
<ul>
<li>程序查询接口</li>
<li>中断接口</li>
<li>DMA接口</li>
</ul>
</li>
<li><p>功能选择的灵活性</p>
<ul>
<li>可编程接口</li>
<li>不可编程接口</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="I-x2F-O端口及其编址"><a href="#I-x2F-O端口及其编址" class="headerlink" title="I&#x2F;O端口及其编址"></a>I&#x2F;O端口及其编址</h3><ul>
<li><p>端口分类</p>
<ul>
<li><p>数据端口</p>
<ul>
<li>CPU读写</li>
</ul>
</li>
<li><p>控制端口</p>
<ul>
<li>只能写</li>
</ul>
</li>
<li><p>状态端口</p>
<ul>
<li>只能读</li>
</ul>
</li>
</ul>
</li>
<li><p>对端口编址</p>
<ul>
<li><p>统一编址(存储器映射方式)</p>
<ul>
<li><p>I&#x2F;O端口和内存一起编址，依靠不同地址码区分，可以固定在任何位置，但不能随意。访存指令（RISC常用此编址法，即LOAD和STORE）可访问I&#x2F;O端口</p>
<ul>
<li>灵活，端口编址空间大，电路简单；慢，占内存容量</li>
</ul>
</li>
</ul>
</li>
<li><p>独立编址(I&#x2F;O映射方式)</p>
<ul>
<li><p>I&#x2F;O端口独立编址，设专门I&#x2F;O指令访问I&#x2F;O端口</p>
<ul>
<li>编程清晰，译码快，不占空间；指令少，灵活性差，电路复杂</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="I-x2F-O方式"><a href="#I-x2F-O方式" class="headerlink" title="I&#x2F;O方式"></a>I&#x2F;O方式</h2><h3 id="程序查询方式"><a href="#程序查询方式" class="headerlink" title="程序查询方式"></a>程序查询方式</h3><ul>
<li><p>（数据线→a,地址线→Rn,控制线→写）→Rn端口，数据缓冲寄存器收下a→等到控制寄存器检测到外设ready→a经过I&#x2F;O控制逻辑、外设界面控制逻辑，通过数据线和控制线将数据传到打印机→打印机完成后在通过I&#x2F;O控制逻辑将状态设为ready</p>
</li>
<li><p>处理时间：CPU和接口间的数据传输时间</p>
</li>
<li><p>没被CPU查询到的状态会被下一次状态覆盖</p>
</li>
<li><p>分类</p>
<ul>
<li><p>定时查询</p>
<ul>
<li>隔段时间来检查一次</li>
</ul>
</li>
<li><p>独占查询</p>
<ul>
<li>一直在这里查</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="程序中断方式"><a href="#程序中断方式" class="headerlink" title="程序中断方式"></a>程序中断方式</h3><ul>
<li><p>中断流程</p>
<ul>
<li><p>CPU在每一条指令执行完后都会检查是否有中断请求（来自中断源）</p>
<ul>
<li><p>中断请求标记</p>
<ul>
<li><p>每个I&#x2F;O设备都有一个INTR触发器，为1则有请求</p>
<ul>
<li><p>非屏蔽中断</p>
<ul>
<li>关中断IF&#x3D;0也会被响应</li>
</ul>
</li>
<li><p>可屏蔽中断</p>
<ul>
<li>关中断时不会被响应</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>中断源</p>
<ul>
<li><p>内中断</p>
<ul>
<li><p>处理器和内存内，地址非法、页面失效、除数为0、非法指令、特权指令、时间片中断、切换到核心态</p>
<ul>
<li>软(件)中断（指令产生，编程实现）属于内中断</li>
</ul>
</li>
</ul>
</li>
<li><p>外中断</p>
<ul>
<li><p>来自处理器和内存外的部件引起，I&#x2F;O中断、用户点击、时钟中断，狭义上的中断</p>
<ul>
<li>硬(件)中断（硬件产生）属于外中断</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>响应中断条件</p>
<ul>
<li>中断源有中断请求</li>
<li>CPU允许中断及开中断</li>
<li>一条指令执行完毕且没有更紧迫的任务</li>
</ul>
</li>
<li><p>中断判优</p>
<ul>
<li><p>软件实现</p>
<ul>
<li><p>查询程序</p>
<ul>
<li>慢</li>
</ul>
</li>
</ul>
</li>
<li><p>硬件实现</p>
<ul>
<li><p>硬件排队器（已定好优先级），用这个</p>
<ul>
<li>硬件&gt;软件；屏蔽&gt;非屏蔽；DMA&gt;I&#x2F;O设备传送；高速&gt;低速；输入&gt;输出；实时&gt;普通。访管（输入输出）&gt;程序性&gt;重新启动</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>中断隐指令</p>
<ul>
<li><p>1、关中断；2、保存断点（存入堆栈）；3、引出中断服务程序</p>
<ul>
<li><p>软件查询法</p>
</li>
<li><p>硬件向量法</p>
<ul>
<li>中断向量（中断程序入口地址）；中断向量地址（入口地址的地址）。存储器其中有一块专门放中断向量表</li>
</ul>
</li>
</ul>
</li>
<li><p>由CPU（硬件）自动完成</p>
</li>
</ul>
</li>
<li><p>不同中断请求用不同中断服务程序</p>
<ul>
<li>1、保护现场（保存寄存器，PC、PSW中的值）2、中断服务 3、恢复现场 5、开中断 4、中断返回指令（已恢复，不需要跳转）</li>
</ul>
</li>
</ul>
</li>
<li><p>多重中断</p>
<ul>
<li>单重中断在执行中断服务程序时不会响应新的中断请求，</li>
</ul>
</li>
</ul>
<p>多重中断会暂停转去处理优先级更高的中断，又称中断嵌套<br>    - 中断屏蔽</p>
<pre><code>    - 每个中断源都有一个屏蔽触发器，1表示屏蔽该源请求，0表示可以正常申请，所有组合在一起构成屏蔽字寄存器

        - 能搞出一个n×n的表格，可调整优先级
</code></pre>
<h2 id="DMA方式"><a href="#DMA方式" class="headerlink" title="DMA方式"></a>DMA方式</h2><h3 id="DMA控制器的组成"><a href="#DMA控制器的组成" class="headerlink" title="DMA控制器的组成"></a>DMA控制器的组成</h3><ul>
<li>完全由硬件实现，只能进行数据传送，不可用于键鼠</li>
<li>1）外设发出DMA请求，外设的设备驱动程序向DMA传送参数，DMA向CPU发出总线请求</li>
<li>2）CPU响应，发出总线响应信号，DMA控制器(DMAC)接管总线控制权，进入DMA操作周期</li>
<li>3）确定传送数据的主存单元地址AR及长度WC，并自动修改主存地址计数+1和长度计数-1</li>
<li>4）得知数据传送方向（主存→外设or外设→主存），发出读写控制信号，执行数据传送</li>
<li>5）向CPU报告DMA操作结束（中断信号）</li>
</ul>
<h3 id="DMA传送过程"><a href="#DMA传送过程" class="headerlink" title="DMA传送过程"></a>DMA传送过程</h3><ul>
<li><p>预处理</p>
<ul>
<li>主存起始地址→AR，I&#x2F;O设备地址→DAR，传送数据个数→WC，启动I&#x2F;O设备</li>
</ul>
</li>
<li><p>数据传送</p>
<ul>
<li>继续执行主程序，同时完成一批数据的传送</li>
</ul>
</li>
<li><p>后处理</p>
<ul>
<li>中断服务程序做DMA结束处理</li>
</ul>
</li>
<li><p>继续执行主程序</p>
</li>
</ul>
<h3 id="DMA传送方式"><a href="#DMA传送方式" class="headerlink" title="DMA传送方式"></a>DMA传送方式</h3><ul>
<li><p>停止CPU访问主存</p>
</li>
<li><p>DMA和CPU交替访存</p>
<ul>
<li>一个CPU周期分成C1（DMA），C2（CPU）</li>
</ul>
</li>
<li><p>周期挪用（窃取）</p>
<ul>
<li><p>CPU不访存</p>
</li>
<li><p>CPU在访存</p>
<ul>
<li>让出总线</li>
</ul>
</li>
<li><p>CPU抢访存</p>
<ul>
<li>I&#x2F;O优先</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="I-x2F-O和主机并行工作，程序和传送并行工作"><a href="#I-x2F-O和主机并行工作，程序和传送并行工作" class="headerlink" title="I&#x2F;O和主机并行工作，程序和传送并行工作"></a>I&#x2F;O和主机并行工作，程序和传送并行工作</h3><ul>
<li>中断方式：并行、串行</li>
</ul>

  </div>
  
</article>
    </main>
    <footer id="footer">
  Copyright &copy;
  2022
  BONE
  
  
    <a class="social-links" target="_blank" rel="noopener" href="https://github.com/FloatinDLE"><i class="blogfont">&#xe6b7; </i></a>
  
    <a class="social-links" href="mailto:bone_n@foxmail.com"><i class="blogfont">&#xe61a; </i></a>
  
    <a class="social-links" href="/atom.xml"><i class="blogfont">&#xe640; </i></a>
  
  
</footer>
    <!-- scripts -->

<script src="/scripts/main.js"></script>

  </body>
</html>